{
  "hash": "b68c139682ee00aabf18177983bb9f1c",
  "result": {
    "markdown": "---\ntitle: \"Lab 4: Elections\"\ndate: 03/03/23\nimage: images/iran_green2.jpg\ncode-fold: false\n---\n<!-- The bit before that is commented out adds publish date to document metadata and button links at the top of the doc. This workflow can be revisited but currently doesn't work because listings aren't updated with these dates, only the renderd docs. -->\n\n::: {.cell}\n\n:::\n\n---\npublished-title: \"release date\"\n---\n\n[[Discuss]{.btn .btn-primary}](https://edstem.org/us/courses/31657) [[Slides]{.btn .btn-primary}](slides.qmd)\n\n\n\nThis week's lab is a *mini-lab* containing only one part and done in a qmd file. The data for this lab can be found in the `iran` data frame in the `stat20data` package. Run `?iran` at the console to learn more about the columns.\n\nYou can pull down these questions in RStudio by running the following command at the console:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_course(\"https://tinyurl.com/lab-4-elections\")\n```\n:::\n\n\nOn June 12 2009, the Republic of Iran held an election where President Mahmoud Ahmadinejad sought re-election against three challengers. One of the challengers, Mir-Hossein Mousavi. When it was announced that Ahmadinejad had won handily, there were widespread allegations of election fraud. There are many methods, both quantitative and qualitative, to detect election fraud. In this lab we will explore just one proposed method.\n\n#### Question 1\n\nWhat is the unit of observation in the `iran` data frame?\n\n\n#### Question 2\n\nWhat is the empirical distribution of the vote counts (by city) for Ahmadinejad? Answer with a plot, numerical summaries of center and spread, and a written interpretation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(stat20data)\n\niran %>%\n  ggplot(aes(x = ahmadinejad)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](lab_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\niran %>%\n  summarize(med_count = median(ahmadinejad),\n            iqr_count = IQR(ahmadinejad))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 2\n  med_count iqr_count\n      <dbl>     <dbl>\n1    35582.    46132.\n```\n:::\n:::\n\n\n\n#### Question 3\n\nOne model for the probability distribution of first digits is the discrete uniform distribution. Let $X$ be the first digit of the vote count for Ahmadinejad in a randomly selected city.\n\n$$X \\sim Uniform(1, 9)$$\n\nWe've started creating the distribution table for $X$ as a data frame by creating a column containing the possible values $x$. Complete the table by mutating and saving a column called `prob` with the corresponding probabilities. Use that table to visualize the distribution and color the bars with gold to make clear this is a probability distribution, not an empirical distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfd_unif <- data.frame(first_digit = seq(1, 9))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfd_unif <- fd_unif %>%\n  mutate(prob = 1/9)\n\nfd_unif %>%\n  ggplot(aes(x = first_digit,\n             y = prob)) +\n  geom_col(fill = \"gold\")\n```\n\n::: {.cell-output-display}\n![](lab_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n#### Question 4\n\nWhat is the expected value of $X \\sim Unif(1, 9)$? Answer this question by mutating a new column in `fd_unif` and taking its sum, as in the notes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpected_first_digit <- fd_unif %>%\n  mutate(product = first_digit * prob) %>%\n  summarize(EX = sum(product)) %>%\n  pull(EX)\n\nexpected_first_digit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5\n```\n:::\n:::\n\n\n#### Question 5\n\nWhat is the variance of $X \\sim Unif(1, 9)$? Answer this question by again mutating a new column in `fd_unif` and taking its sum, as in the notes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nvar_first_digit <- fd_unif %>%\n  mutate(product = (first_digit - expected_first_digit)^2 * prob) %>%\n  summarize(VX = sum(product)) %>%\n  pull(VX)\n\nvar_first_digit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.666667\n```\n:::\n:::\n\n\n#### Question 6\n\nA second model for the probability distribution of first digits is Benford's Law.\n\n$$X ~ Benford()$$\n\nBenford's Law is a distribution without any parameters: it always takes values on the integers from 1 to 9 and the probability of each is $\\log_{10} \\left(1 + 1/x\\right)$ where $x$ is the integer.\n\nRepeat question 2 but using Benford's Law and the dataframe `fd_benford`. As a check that your table represents a valid probability distribution, verify that the sum of `prob` is 1. (Hint: read the documentation to `log()` carefully.)\n\nWill this distribution have a expected value that is higher, lower, or the same as the Uniform distribution?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfd_benford <- data.frame(first_digit = seq(1, 9))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfd_benford <- fd_benford %>%\n  mutate(prob = log(1 + 1/first_digit, base = 10))\n\nfd_benford %>%\n  ggplot(aes(x = first_digit,\n             y = prob)) +\n  geom_col(fill = \"gold\")\n```\n\n::: {.cell-output-display}\n![](lab_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n#### Question 7\n\nUsing the methods from Questions 4 and 5, calculate the expected value and the variance of Benford's Law.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpected_first_digit <- fd_benford %>%\n  mutate(product = first_digit * prob) %>%\n  summarize(EX = sum(product)) %>%\n  pull(EX)\n\nvar_first_digit <- fd_benford %>%\n  mutate(product = (first_digit - expected_first_digit)^2 * prob) %>%\n  summarize(VX = sum(product)) %>%\n  pull(VX)\n\nexpected_first_digit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.440237\n```\n:::\n\n```{.r .cell-code}\nvar_first_digit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 6.056513\n```\n:::\n:::\n\n\n\n#### Question 8\n\nWhat might a sample of 366 draws from $X \\sim Benford()$ look like?\n\nTo answer this, use `fd_benford` as your box with every row a ticket. You can simulate the process of drawing a ticket out of a box by sampling rows from the data frame with `slice_sample()`. To use this function you must specify the number of rows (`n`), whether or not to sample with replacement (`replace`), and which column contains the probability of each ticket (`weight_by`).\n\nCreate a plot of the resulting distribution of first digits.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# fd_benford %>%\n#   slice_sample(n = ___, \n#                replace = ___, \n#                weight_by = ___)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfd_benford %>%\n  slice_sample(n = nrow(iran),\n               replace = TRUE,\n               weight_by = prob)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    first_digit       prob\n1             1 0.30103000\n2             1 0.30103000\n3             2 0.17609126\n4             1 0.30103000\n5             1 0.30103000\n6             7 0.05799195\n7             9 0.04575749\n8             1 0.30103000\n9             1 0.30103000\n10            5 0.07918125\n11            2 0.17609126\n12            2 0.17609126\n13            9 0.04575749\n14            2 0.17609126\n15            2 0.17609126\n16            9 0.04575749\n17            5 0.07918125\n18            1 0.30103000\n19            1 0.30103000\n20            3 0.12493874\n21            9 0.04575749\n22            1 0.30103000\n23            1 0.30103000\n24            1 0.30103000\n25            7 0.05799195\n26            2 0.17609126\n27            1 0.30103000\n28            4 0.09691001\n29            1 0.30103000\n30            4 0.09691001\n31            2 0.17609126\n32            4 0.09691001\n33            4 0.09691001\n34            1 0.30103000\n35            8 0.05115252\n36            1 0.30103000\n37            1 0.30103000\n38            2 0.17609126\n39            1 0.30103000\n40            1 0.30103000\n41            1 0.30103000\n42            8 0.05115252\n43            4 0.09691001\n44            5 0.07918125\n45            7 0.05799195\n46            3 0.12493874\n47            1 0.30103000\n48            1 0.30103000\n49            7 0.05799195\n50            4 0.09691001\n51            4 0.09691001\n52            1 0.30103000\n53            4 0.09691001\n54            7 0.05799195\n55            1 0.30103000\n56            2 0.17609126\n57            1 0.30103000\n58            4 0.09691001\n59            7 0.05799195\n60            1 0.30103000\n61            1 0.30103000\n62            1 0.30103000\n63            7 0.05799195\n64            4 0.09691001\n65            3 0.12493874\n66            4 0.09691001\n67            5 0.07918125\n68            9 0.04575749\n69            4 0.09691001\n70            1 0.30103000\n71            1 0.30103000\n72            2 0.17609126\n73            2 0.17609126\n74            2 0.17609126\n75            3 0.12493874\n76            5 0.07918125\n77            1 0.30103000\n78            2 0.17609126\n79            1 0.30103000\n80            1 0.30103000\n81            6 0.06694679\n82            4 0.09691001\n83            5 0.07918125\n84            6 0.06694679\n85            6 0.06694679\n86            4 0.09691001\n87            4 0.09691001\n88            1 0.30103000\n89            2 0.17609126\n90            2 0.17609126\n91            2 0.17609126\n92            1 0.30103000\n93            3 0.12493874\n94            7 0.05799195\n95            3 0.12493874\n96            1 0.30103000\n97            4 0.09691001\n98            9 0.04575749\n99            5 0.07918125\n100           3 0.12493874\n101           5 0.07918125\n102           1 0.30103000\n103           1 0.30103000\n104           1 0.30103000\n105           8 0.05115252\n106           5 0.07918125\n107           1 0.30103000\n108           1 0.30103000\n109           5 0.07918125\n110           2 0.17609126\n111           9 0.04575749\n112           2 0.17609126\n113           1 0.30103000\n114           2 0.17609126\n115           6 0.06694679\n116           6 0.06694679\n117           1 0.30103000\n118           9 0.04575749\n119           3 0.12493874\n120           9 0.04575749\n121           1 0.30103000\n122           8 0.05115252\n123           1 0.30103000\n124           1 0.30103000\n125           1 0.30103000\n126           1 0.30103000\n127           5 0.07918125\n128           2 0.17609126\n129           1 0.30103000\n130           2 0.17609126\n131           4 0.09691001\n132           1 0.30103000\n133           1 0.30103000\n134           4 0.09691001\n135           1 0.30103000\n136           4 0.09691001\n137           3 0.12493874\n138           3 0.12493874\n139           5 0.07918125\n140           3 0.12493874\n141           4 0.09691001\n142           5 0.07918125\n143           2 0.17609126\n144           5 0.07918125\n145           2 0.17609126\n146           4 0.09691001\n147           6 0.06694679\n148           2 0.17609126\n149           2 0.17609126\n150           4 0.09691001\n151           1 0.30103000\n152           2 0.17609126\n153           1 0.30103000\n154           1 0.30103000\n155           2 0.17609126\n156           1 0.30103000\n157           1 0.30103000\n158           6 0.06694679\n159           5 0.07918125\n160           1 0.30103000\n161           1 0.30103000\n162           3 0.12493874\n163           4 0.09691001\n164           1 0.30103000\n165           3 0.12493874\n166           1 0.30103000\n167           4 0.09691001\n168           7 0.05799195\n169           8 0.05115252\n170           3 0.12493874\n171           5 0.07918125\n172           1 0.30103000\n173           3 0.12493874\n174           3 0.12493874\n175           2 0.17609126\n176           1 0.30103000\n177           1 0.30103000\n178           3 0.12493874\n179           6 0.06694679\n180           9 0.04575749\n181           5 0.07918125\n182           1 0.30103000\n183           6 0.06694679\n184           1 0.30103000\n185           2 0.17609126\n186           7 0.05799195\n187           1 0.30103000\n188           1 0.30103000\n189           1 0.30103000\n190           1 0.30103000\n191           5 0.07918125\n192           4 0.09691001\n193           1 0.30103000\n194           1 0.30103000\n195           1 0.30103000\n196           1 0.30103000\n197           4 0.09691001\n198           2 0.17609126\n199           8 0.05115252\n200           3 0.12493874\n201           3 0.12493874\n202           4 0.09691001\n203           3 0.12493874\n204           7 0.05799195\n205           7 0.05799195\n206           8 0.05115252\n207           3 0.12493874\n208           1 0.30103000\n209           5 0.07918125\n210           7 0.05799195\n211           6 0.06694679\n212           8 0.05115252\n213           3 0.12493874\n214           5 0.07918125\n215           1 0.30103000\n216           1 0.30103000\n217           1 0.30103000\n218           9 0.04575749\n219           1 0.30103000\n220           2 0.17609126\n221           3 0.12493874\n222           7 0.05799195\n223           2 0.17609126\n224           1 0.30103000\n225           9 0.04575749\n226           1 0.30103000\n227           1 0.30103000\n228           2 0.17609126\n229           1 0.30103000\n230           2 0.17609126\n231           1 0.30103000\n232           9 0.04575749\n233           1 0.30103000\n234           3 0.12493874\n235           1 0.30103000\n236           6 0.06694679\n237           2 0.17609126\n238           4 0.09691001\n239           3 0.12493874\n240           1 0.30103000\n241           1 0.30103000\n242           2 0.17609126\n243           9 0.04575749\n244           7 0.05799195\n245           3 0.12493874\n246           1 0.30103000\n247           1 0.30103000\n248           3 0.12493874\n249           5 0.07918125\n250           4 0.09691001\n251           6 0.06694679\n252           8 0.05115252\n253           6 0.06694679\n254           7 0.05799195\n255           7 0.05799195\n256           1 0.30103000\n257           9 0.04575749\n258           1 0.30103000\n259           8 0.05115252\n260           4 0.09691001\n261           1 0.30103000\n262           2 0.17609126\n263           1 0.30103000\n264           1 0.30103000\n265           5 0.07918125\n266           1 0.30103000\n267           4 0.09691001\n268           7 0.05799195\n269           7 0.05799195\n270           2 0.17609126\n271           3 0.12493874\n272           4 0.09691001\n273           1 0.30103000\n274           2 0.17609126\n275           7 0.05799195\n276           4 0.09691001\n277           7 0.05799195\n278           2 0.17609126\n279           1 0.30103000\n280           1 0.30103000\n281           2 0.17609126\n282           1 0.30103000\n283           2 0.17609126\n284           1 0.30103000\n285           1 0.30103000\n286           5 0.07918125\n287           2 0.17609126\n288           3 0.12493874\n289           2 0.17609126\n290           3 0.12493874\n291           5 0.07918125\n292           2 0.17609126\n293           2 0.17609126\n294           3 0.12493874\n295           2 0.17609126\n296           2 0.17609126\n297           2 0.17609126\n298           1 0.30103000\n299           4 0.09691001\n300           2 0.17609126\n301           9 0.04575749\n302           1 0.30103000\n303           1 0.30103000\n304           1 0.30103000\n305           6 0.06694679\n306           1 0.30103000\n307           3 0.12493874\n308           4 0.09691001\n309           1 0.30103000\n310           2 0.17609126\n311           3 0.12493874\n312           2 0.17609126\n313           5 0.07918125\n314           1 0.30103000\n315           5 0.07918125\n316           5 0.07918125\n317           7 0.05799195\n318           5 0.07918125\n319           3 0.12493874\n320           2 0.17609126\n321           5 0.07918125\n322           9 0.04575749\n323           2 0.17609126\n324           2 0.17609126\n325           3 0.12493874\n326           1 0.30103000\n327           1 0.30103000\n328           3 0.12493874\n329           6 0.06694679\n330           8 0.05115252\n331           2 0.17609126\n332           1 0.30103000\n333           8 0.05115252\n334           1 0.30103000\n335           3 0.12493874\n336           5 0.07918125\n337           4 0.09691001\n338           4 0.09691001\n339           3 0.12493874\n340           4 0.09691001\n341           1 0.30103000\n342           9 0.04575749\n343           3 0.12493874\n344           1 0.30103000\n345           6 0.06694679\n346           2 0.17609126\n347           2 0.17609126\n348           9 0.04575749\n349           2 0.17609126\n350           4 0.09691001\n351           6 0.06694679\n352           1 0.30103000\n353           4 0.09691001\n354           1 0.30103000\n355           5 0.07918125\n356           2 0.17609126\n357           2 0.17609126\n358           8 0.05115252\n359           7 0.05799195\n360           2 0.17609126\n361           3 0.12493874\n362           7 0.05799195\n363           1 0.30103000\n364           3 0.12493874\n365           5 0.07918125\n366           1 0.30103000\n```\n:::\n:::\n\n\n\n\n#### Question 8\n\nWhat do the first digit empirical distributions look like for the four candidates in the Iranian presidential election?\n\nInside the `stat20data` package there is a function called `get_first()` that pulls off the first digit of every element in a vector. Piece all four plots together into one single plot using the `patchwork` library (see <https://www.stat20.org/2-describing-data/05-summarizing-numerical-data/notes.html#constructing-graphical-summaries> for an example of its use).\n\n\n::: {.cell}\n\n```{.r .cell-code}\npenguins %>%\n  mutate(first_digit = get_first(bill_length_mm)) %>%\n  select(bill_length_mm, first_digit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 333 × 2\n   bill_length_mm first_digit\n            <dbl>       <dbl>\n 1           39.1           3\n 2           39.5           3\n 3           40.3           4\n 4           36.7           3\n 5           39.3           3\n 6           38.9           3\n 7           39.2           3\n 8           41.1           4\n 9           38.6           3\n10           34.6           3\n# … with 323 more rows\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# repeat this four times, one for each candidate\niran %>%\n  mutate(first_digit = get_first(ahmadinejad)) %>%\n  ggplot(aes(x = first_digit)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](lab_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n#### Question 9\n\nHow do the observed first digit distributions compare to those simulated from Benford's Law? Which candidate has a first-digit distribution most similar to and most different from the simulated ones?\n\n### US Elections\n\nThe [OpenElections](http://www.openelections.net) project obtains and standardizes precinct-level results from US elections, including the 2020 US Presidential Election. To access the data, search OpenElections' GitHub page ([https://github.com/openelections](https://github.com/openelections)) and click on a link to a data repository for the state of your choosing. Select the `2020` folder and find a file that ends in `.csv`. Some notes:\n\n- Each state uses a different format, so click through a couple states' repositories until you find one that will allow you to study voting patterns at the precinct-level.\n- To read the csv file into R, you will need to point R to the raw version of the data set. To view the raw csv you will either click the button that says \"Raw\" at the top right of the data frame on GitHub or click the link that says \"View Raw Data\". When you are looking at the raw csv file, the url in your browser is the one you can use to access the file from within R.\n- There may be strange extra rows in your data, such as a row tallying total overall votes. Visually inspect the data to see if anything jumps out and be sure to take this into consideration when doing your analysis.\n\n#### Question 10\n\nWhat state did you choose to study? What is the unit of observation in your state's data frame? What are the dimensions?\n\n#### Question 11\n\nUse this data to create a plot of that state's first digit distribution by precinct. Use the number of votes cast for Joseph Biden in each precinct.\n\n#### Question 12\n\nDoes the election you chose appear to fit Benford's distribution better or worse than the Iran election?",
    "supporting": [
      "lab_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}